"use strict";const btn=document.querySelector(".js-button"),reset=document.querySelector(".js-btnReset"),searchInput=document.querySelector(".js-search"),list=document.querySelector(".js-list"),listFav=document.querySelector(".js-listFav"),btnFav=document.querySelector(".js-btnFav"),resetIconFav=document.querySelector(".js-resetIconFav");let results=[],favorites=[],newFav=[];function clearResults(){results=""}function handleReset(e){let t=renderList;e.preventDefault(),clearResults(),list.innerHTML="",t=""}function handleResetFav(e){e.preventDefault(),favorites=[],listFav.innerHTML="",localStorage.removeItem("data"),btnFav.classList.add("hidden")}function handleFav(e){const t=parseInt(e.currentTarget.id),s=results.data.find(e=>e.mal_id===t),a=favorites.findIndex(e=>e.mal_id===t);-1===a?(favorites.push(s),btnFav.classList.contains("hidden")&&btnFav.classList.remove("hidden")):favorites.splice(a,1),renderList(),renderFav(),listenerAnime(),localStorage.setItem("data",JSON.stringify(favorites))}function renderFav(){let e=[];for(const t of favorites)e+=`<li class='favItem fav-colorList js-favList' id='${t.mal_id}'>`,e+=`<h2 class= 'title-fav  js-favTitle'>${t.title} </h2>`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===t.images.jpg.image_url?e+="<img src=https://via.placeholder.com/210x295/ffffff/666666/?text=TV class='imageFav' alt=\"imagen\"/>":e+=`<img src='${t.images.jpg.image_url}' alt='img' class='js-imageFav imageFav'/>`,e+=`<button id='${t.mal_id}' class='resetIconFav js-resetIconFav'><i class='fa-solid fa-circle-xmark'></i></button>`;listFav.innerHTML=e,listenerResetFav(),listenerAnime()}function listenerAnime(){const e=document.querySelectorAll(".js-eachList");for(const t of e)t.addEventListener("click",handleFav)}reset.addEventListener("click",handleReset),btnFav.addEventListener("click",handleResetFav),btn.addEventListener("click",e=>{e.preventDefault();let t=searchInput.value;fetch("https://api.jikan.moe/v4/anime?q="+t).then(e=>e.json()).then(e=>{results=e,renderList(results)})});const renderList=e=>{let t="",s="";for(const e of results.data){const a="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png";s=-1!==favorites.findIndex(t=>e.mal_id===t.mal_id)?"fav-color":"",t+=`<li class= 'list  js-eachList ${s}' id='${e.mal_id}'>`,e.images.jpg.image_url===a?t+="<img src=https://via.placeholder.com/210x295/ffffff/666666/?text=TV class='image' alt=\"imagen\"/>":t+=`<img src='${e.images.jpg.image_url}' alt='img' class='js-image image'/>`,t+=`<h2 class= 'title js-title ${s}'>${e.title} </h2>`}list.innerHTML=t,listenerAnime()};function onLoad(){const e=JSON.parse(localStorage.getItem("data"));e&&(favorites=e,renderFav())}function handleResetEachFav(e){e.preventDefault();const t=parseInt(e.currentTarget.id),s=favorites.findIndex(e=>e.mal_id===t);btnFav.classList.add("hidden"),-1!==s&&(favorites.splice(s,1),btnFav.classList.contains("hidden")&&btnFav.classList.remove("hidden")),renderFav(),listenerResetFav(),localStorage.setItem("data",JSON.stringify(favorites))}function listenerResetFav(){const e=document.querySelectorAll(".js-resetIconFav");for(const t of e)t.addEventListener("click",handleResetEachFav)}onLoad();